<head>
<link rel="stylesheet" href="../../style.css" type="text/css">
</head>
<a href="javascript:history.go(-1)" onMouseOver="self.status=document.referrer;return true">Go Back</a>
<p align='right'><a href='ion.tar.gz'>Source code</a></p>
<body>
<div class="main">
 <div class="mid" id="dm">
  <div class="content" id="dmc">
   <h2>
    Details
   </h2>
   <p>
    Name: ion
    <br/>
    Created: Jan 25, 2011
    <br/>
    Updated: Jun 11, 2015
    <br/>
    SVN Updated: Jan 15, 2014
    
    
    
    
    
    
   </p>
   <h2>
    Other project properties
   </h2>
   <p>
    Category:
    
     Processor
    
    <br/>
    Language:
    
     VHDL
    
    <br/>
    Development status:
    
     Mature
    
    <br/>
    Additional info:
    <br/>
    WishBone Compliant: No
    <br/>
    License: LGPL
   </p>
   <div id="d_WARNING">
    <h2>
     
     
     WARNING
    </h2>
    <p id="p_WARNING">
     This project is in the middle of a major refactor, being conducted in
     
      a new GitHub repository
     
     .
     The refactor involves rewriting from scratch the most intractably messy parts of the RTL (the cache and memory controller and parts of the CPU), going to a 4-stage pipeline, implementing Wishbone as the main bus interface, implementing a generic COP2 interface and a few other changes. The aim is to make the core actually useable.
     In particular, the CPU monitor in the TB is being rewritten from scratch, as the current version is just too unmaintainable.
     Eventually the project will be backported here. ETA is around the end of Summer 2015.
     In short, I wouldn't recommend paying much attention to
     version of the core...
    </p>
   </div>
   <div id="d_Overview">
    <h2>
     
     
     Overview
    </h2>
    <p id="p_Overview">
     This is a MIPS-I compatible CPU, aiming at compatibility with IDT&#8217;s
     
      R3000
     
     MIPS derivative.
     <h3>
      Key features:
     </h3>
     <table>
      <tr>
       <td>
        1.
       </td>
       <td>
        Binary compatible to R3000 series of CPUs.
       </td>
      </tr>
      <tr>
       <td>
        2.
       </td>
       <td>
        Kernel/user mode operation as per the architecture definition.
       </td>
      </tr>
      <tr>
       <td>
        3.
       </td>
       <td>
        Exception handling compatible to MIPS-I standard.
       </td>
      </tr>
      <tr>
       <td>
        4.
       </td>
       <td>
        4KB direct-mapped code cache.
       </td>
      </tr>
      <tr>
       <td>
        5.
       </td>
       <td>
        4KB direct-mapped, writethrough data cache.
       </td>
      </tr>
      <tr>
       <td>
        6.
       </td>
       <td>
        Simplified CP0, mostly compatible to R3000.
       </td>
      </tr>
      <tr>
       <td>
        7.
       </td>
       <td>
        All unimplemented opcodes trigger the proper traps.
       </td>
      </tr>
      <tr>
       <td>
        8.
       </td>
       <td>
        Includes minimalistic memory handler with interfaces for external SRAM (or FLASH)
on 8- and 16-bit data bus.
       </td>
      </tr>
      <tr>
       <td>
        9.
       </td>
       <td>
        Size and speed comparable to other free MIPS cores.
       </td>
      </tr>
      <tr>
       <td>
        10.
       </td>
       <td>
        Fully synchronous (rising clock edge only). No latches.
       </td>
      </tr>
      <tr>
       <td>
        11.
       </td>
       <td>
        Source HDL is fully vendor independent (Only tested on Xilinx and Altera synthesis
tools).
       </td>
      </tr>
     </table>
     This project inherits heavily from Steve Rhoads'
     
      Plasma
     
     , though it is not meant as a replacement or improvement -- the name of this project attempts to convey that idea.
     Besides using Plasma as a benchmark and model, I have used parts of Plasma in this project. This includes the multiplier/divider unit and the software simulator, both of which have been extensively modified -- details are covered in the source comments and the documentation.
     Please see the included documentation (/doc/ion_project.pdf) for a more detailed explaination of the core features and its current status.
     The project ships with a few
     
      demos
     
     , including a port of Adventure for a bare-metal system and a SD card bootloader.
     While this project may eventually produce a useful MIPS CPU core, and is not bad in area and clock rate performance, the real reason I took all this trouble is that it's lots of fun :)
     <h4>
      Important:
     </h4>
     While the core can already run almost any arbitrary code, it is not mature enough to be of any immediate use in real-life applications. If you are looking for a mature, well supported and well tested MIPS core, you need to look elsewhere.
     There's already quite a few MIPS cores out there to choose from, including some in OpenCores.
     <h4>
      Feedback:
     </h4>
     Though I don't expect this core to be used at all at this early stage, you can contact me with any doubt and/or correction. Bear in mind that neither the source code nor the documentation have ever been reviewed -- all criticism and feedback is welcome!
    </p>
   </div>
   <div id="d_Status">
    <h2>
     
     
     Status
    </h2>
    <p id="p_Status">
     The core is still a work in progress. The main missing features are these, in order of priority:
     <table>
      <tr>
       <td>
        1.
       </td>
       <td>
        Real documentation (specs doc &amp; data sheet) missing.
       </td>
      </tr>
      <tr>
       <td>
        2.
       </td>
       <td>
        Logic is too messy, specially the cache-cpu interface. It needs a refactor.
       </td>
      </tr>
      <tr>
       <td>
        3.
       </td>
       <td>
        Hardware interrupts not implemented.
       </td>
      </tr>
      <tr>
       <td>
        4.
       </td>
       <td>
        Memory handler does not support dynamic RAM.
       </td>
      </tr>
      <tr>
       <td>
        5.
       </td>
       <td>
        Integration with MIPS toolchains is poor -- cannot yet use a standard libc.
       </td>
      </tr>
      <tr>
       <td>
        6.
       </td>
       <td>
        Caches are not configurable or parametrizable.
       </td>
      </tr>
     </table>
     I have found much more trouble than I expected setting up a toolchain for this core. All the MIPS toolchains generally available (and, most importantly, all the libc libraries) target the MIPS32 architecture.
     <br/>
     I have been able to temporarily overcome this problem by emulating the most common mips32-only opcodes (in trap routines) but clearly I need to set up a proper toolchain if this project is to be of any practical use. I may have painted myself into a corner by choosing the mips-I architecture...
     Another thing holding me back is the lack of a suitable FPGA platform for development (one with sufficient memory, for instance).
     In short, this being a leisure project, I will complete the work as time permits. Don't hold your breath :)
    </p>
   </div>
   <div id="d_Performance">
    <h2>
     
     
     Performance
    </h2>
    <p id="p_Performance">
     <h4>
      Synthesis Results
     </h4>
     These are the synthesis results for the current revision of the core using Altera and Xilinx tools:
     <br/>
     <br/>
     <table border="1" cellspacing="0" cellpadding="4">
      <tbody>
       <tr>
        <td>
         Device
        </td>
        <td>
         Synthesis Options
        </td>
        <td>
         Clock Rate
        </td>
        <td>
         Area (excluding memory blocks)
        </td>
       </tr>
       <tr>
        <td>
         Altera Cyclone-2 (-7)
        </td>
        <td>
         Balanced
        </td>
        <td>
         50 MHz
        </td>
        <td>
         2349 LEs
        </td>
       </tr>
       <td>
        Xilinx Spartan-3 (-5)
       </td>
       <td>
        Speed
       </td>
       <td>
        51 MHz
       </td>
       <td>
        3173 LUTs
       </td>
       <td>
        Xilinx Virtex-5 (-1)
       </td>
       <td>
        Speed
       </td>
       <td>
        104 MHz
       </td>
       <td>
        2017 LUTs
       </td>
      </tbody>
     </table>
     <br/>
     These results include the CPU core with its default cache and a small, hardwired UART. They have been obtained with Quartus-2 11.1 sp2 and Xilinx ISE WebPack 14.3. The synthesis has been performed unconstrained and the results must be considered illustrative only.
     <br/>
     <br/>
     I haven't yet ported any standard benchmark but anyway the system is not geared towards performance (the cache in particular is too simple) so speed results will not be outstanding.
     <br/>
     <br/>
    </p>
   </div>
   <div id="d_Updates">
    <h2>
     
     
     Updates
    </h2>
    <p id="p_Updates">
     Last 'known good' revision is
     <b>
      rev. 242
     </b>
     .
     With 'known good' I mean it has been checked out and all the code samples have been simulated and run on real hardware.
     I use to commit changes piecemeal, so any given revision may contain inconsistent files. You are advised to checkout the last known good revision of the project through SVN, instead of using the download link. Just in case you catch me in the middle of a multi-commit update.
     <b>
      Revision 250
     </b>
     has been tried on the development board but not verified on simulation.
     <h3>
      Revisions:
     </h3>
     <b>
      November 15 2012 -- rev. 250
     </b>
     Added a new demo, a bootloader that can load a binary from the DE-1 SD card onto RAM and run it from there. Already tested with a new version of the Adventure demo (precompiled binary included).
     There is also a port of Elm-Chan's FAT32 library, modified to work on a bit-banged interface.
     And a new link script meant for applications that run from RAM at address 0x0. The only demo using it right now is Adventure, that can now be compiled to run from flash of from RAM via the SD card.
     <b>
      November 15 2012 -- rev. 242
     </b>
     Fixed an erratic behavior detected in the 'Hello World' demo: sometimes, the system crashed immediately after reset.
     The problem has been traced to a corner condition in the cache-cpu interface logic that is briefly explained in the bugtracker page.
     The fix involves a minor change in the I-Cache logic interfacing the CPU: the CPU will not load its IR with a code word from the cache unless it knows the code word is valid, which will only happen after the first code refill (the first after a reset).
     Also fixed a few loose ends: the test bench had not been updated for some of the latest changes in the mini-SoC, so the simulation has been broken for I don't know how long...
     Anyway, the logic is way too messy and could use some refactoring.
     <b>
      June 20 2012 -- rev. 231
     </b>
     Created new SoC entity built around the CPU and a hardwired UART. Good enough as a demonstration platform.
     This SoC module replaces an earlier MCU module which was similar but more complex and difficult to set up.
     Added new tool for VHDL package generation, used to configure the simulation and the synthesis, including the initialization of the simulated and inferred memories. This new tool is now used in all software samples.
     These changes have entailed some major reorganization of the code; this revision has been checked out and tested but if you encounter any trouble, please revert to revision 214!
     Note: A long list of updates, dating back to the start of the project, used to be present in this page but was lost in a page  editing accident as of revision 231. For details on earlier revisions please refer to the SVN logs.
    </p>
   </div>
  </div>
  <div style="clear:both;margin-left:200px;">
  </div>
 </div>
</div>
</body>
<p id='foot'>Database updated on 12 June 2015</p>
