<head>
<link rel="stylesheet" href="../../style.css" type="text/css">
</head>
<a href="javascript:history.go(-1)" onMouseOver="self.status=document.referrer;return true">Go Back</a>
<p align='right'><a href='sp6_pic32.tar.gz'>Source code</a></p>
<body>
<div class="main">
 <div class="mid" id="dm">
  <div class="content" id="dmc">
   <h2>
    Details
   </h2>
   <p>
    Name: sp6_pic32
    <br/>
    Created: Apr 13, 2015
    <br/>
    Updated: Apr 14, 2015
    <br/>
    SVN Updated: Apr 13, 2015
    
    
    
    
    
    
   </p>
   <h2>
    Other project properties
   </h2>
   <p>
    Category:
    
     Prototype board
    
    <br/>
    Language:
    
     VHDL
    
    <br/>
    Development status:
    
     Mature
    
    <br/>
    Additional info:
    <br/>
    WishBone Compliant: No
    <br/>
    License: LGPL
   </p>
   <div id="d_Description">
    <h2>
     
     
     Description
    </h2>
    <p id="p_Description">
     Here i present a board with PCB and schematic included .
     <br/>
     the board include :
     <br/>
     -Spartan 6 FPGA (XC6SLX9)
     <br/>
     -PIC32MZ2048 processor (High range processor from Microchip , 200Mhz MIPS core)
     <br/>
     -high speed USB (device)
     <br/>
     -Ethernet 100Mb/s with LAN8720 transceiver chip
     <br/>
     -I/O header to FPGA pins :  18x 5.0V output (buffered with 74HCT04) and 20x 3.3V Input/output (no buffered)
     <br/>
     the connection between CPU and FPGA include complete EBI (Enhanced bus interface) bus , which permit CPU to read/write FPGA registers (just like a coprocessor arrangment).
     <br/>
     The board have been completely tested , in the case of a CNC motor controller.
     <br/>
     As a note , the FPGA is rapidly full if trying to put a complex design in it with more than 100x 16bit regsiters , but it can support a medium design (with less than 100 registers ..)
     <br/>
     The needed power supply is 5.0V , the board include switch converter chip(s) to produce 1.2V and 3.3V for FPGA core and I/O .
     <br/>
     I have spare PCB or complete assembled boards for anyone interested.
     <br/>
     <br/>
    </p>
   </div>
   <div id="d_board photo">
    <h2>
     
     
     board photo
    </h2>
    <p id="p_board photo">
     javascript:alert('
     <img src="usercontent,img,1428923897" alt="Image1"/>
     ');
    </p>
   </div>
   <div id="d_Spare pcb">
    <h2>
     
     
     Spare pcb
    </h2>
    <p id="p_Spare pcb">
     javascript:alert('
     <img src="usercontent,img,1428924373" alt="spare_pcb2"/>
     ');
    </p>
   </div>
   <div id="d_Bill of material">
    <h2>
     
     
     Bill of material
    </h2>
    <p id="p_Bill of material">
     IC1	PIC32MZ2048ECH144 (QFP-144 - 0.5)
     <br/>
     IC2	LAN8720 (QFN-24)
     <br/>
     IC3	XC6SLX9 (QFP-144 - 0.5)
     <br/>
     IC4,IC5	MP2105DJ (TSOT23-5 switch supply chip for FPGA and CPU)
     <br/>
     IC6,IC7,IC8	74HCT04 (SOIC-1.27)
     <br/>
     JP1	5V jack
     <br/>
     USB	usb type 'B'
     <br/>
     RJ45	rj45 (Hanrun 911103A)
     <br/>
     J1,J2,J3	JST-8P
     <br/>
     JI1,JI2		JST-12P
     <br/>
     JTAG	JST-1.25-6P (JTAG connector)
     <br/>
     ICSP	JST-1.25-5P (ICSP connector)
     <br/>
     L1	ferrite bead size 0805
     <br/>
     L2,L3	inductor 4.7uH	 (Taido NR4018T4R7)
     <br/>
     Led : standard RGB led (common anode)
     <br/>
     OSC	ASEMB-24Mhz (Abracon type ASEMB)
     <br/>
     <br/>
     R1	10K 0603 (MCLR)
     <br/>
     R2	1K 0603 (led)
     <br/>
     R4,R5	330R 0603 (RJ45-leds)
     <br/>
     R6	12.1K 0603 (phy)
     <br/>
     R7	10R 0603 (phy2)
     <br/>
     R9	10K 0603 (MDIO)
     <br/>
     R10,R11	R10=2K2 R11=10K 0603 (supply 3.3V)
     <br/>
     R12,R13	10K 0603 (supply 1.2V)
     <br/>
     R14	330R 0603 (fpga done pin)
     <br/>
     R15,R16	4K7 0603 (fpga program_b,init_b pins)
     <br/>
     C1,C2	47uF 1206 (supply 1.2V)
     <br/>
     C3	100nF 0603 (MCLR)
     <br/>
     C5	47uF 1206 (CPU decoupling)
     <br/>
     C6,C7,C8,C9	100nF 0603 ( MCU decoupling)
     <br/>
     C10,C11	47uF 1206  (supply 3.3V)
     <br/>
     C12,C13	4.7uF 0603 (phy)
     <br/>
     C14,C15	100nF 0603 (phy)
     <br/>
     C16	4.7uF 0603 (phy)
     <br/>
     C17	1uF 0603 (phy)
     <br/>
     C18	470pFb 0603 (phy)
     <br/>
     C19	4u7 0603 (phy)
     <br/>
     C20	100nF 0603 (phy)
     <br/>
     C21	22nF 0603 (phy2)
     <br/>
     C22	100nf 0603 (decoupling osc)
     <br/>
     C23-C30	100nF 0603  (decoupling fpga)
     <br/>
     <br/>
     <br/>
    </p>
   </div>
   <div id="d_pcb">
    <h2>
     
     
     pcb
    </h2>
    <p id="p_pcb">
     javascript:alert('
     <img src="usercontent,img,1428925329" alt="pcb"/>
     ');
javascript:alert('
     <img src="usercontent,img,1428925510" alt="pcb_b"/>
     ');
    </p>
   </div>
   <div id="d_programming the FPGA">
    <h2>
     
     
     programming the FPGA
    </h2>
    <p id="p_programming the FPGA">
     The FPGA can be configured by the JTAG connector and a Xilinx cable , but also by PIC32 CPU at startup (without needing additional flash memory or JTAG connection)
     <br/>
     In ISE design suite , choose to generate a ".bin file" file , additionnaly to the ".bit file"
     <br/>
     The bin data file can be sent directly by the CPU to the FPGA via DIN/CCLK pins .
     <br/>
     This is very fast  (0.5 s). the CPU drive the pins CCLK at 50Mhz without wait  (maybe one or two  NOP is enough wait )
     <br/>
     the PIC32MZ2048 has 2048KByte flash, and can easily contain the FPGA configuration (300KB) as an uncompressed C array .
     <br/>
     Note than other pins that can be driven / read by the CPU are:
     <br/>
     INIT_B /DONE / PROGRAM_B . INIT_B and PROGRAM_B are used to reset the fpga and start programming . int is explained in Xilinx litterature.
     <br/>
     DONE indicate successful operation , but it works all time , previsibly.
     <br/>
    </p>
   </div>
   <div id="d_CPU to FPGA communication">
    <h2>
     
     
     CPU to FPGA communication
    </h2>
    <p id="p_CPU to FPGA communication">
     The complete PIC32 EBI bus signals is connected in this card to the FPGA.
     <br/>
     EBI is a 16 bit data / address bus that the PIC32 use to read/write  to external peripherals .
     <br/>
     the EBI speed is 100Mhz . So the data rate could be 100e^e6 x 16 bps.
     <br/>
     the Spartan 6 FPGA does not need wait states,
     <br/>
     For sync purpose , the FPGA registers could be doubled.
     <br/>
     The EBI R/W and OE are connected to FPGA GCLK signals , this can ease timing design.
     <br/>
     EBI include also CS (chip select ) for 4 peripherals , EBIRDY (for waits states in case of slow peripherals)
     <br/>
     In this board , they is also additionally about 20 generic CPU I/O connected to generic FPGA pins.
     <br/>
     The CPU RTS pins are able to output up to 100Mhz fixed clock if correctly configured (PIC32 COM BCLK mode ), this is used to clock the FPGA.
     <br/>
     <br/>
    </p>
   </div>
   <div id="d_Schematic">
    <h2>
     
     
     Schematic
    </h2>
    <p id="p_Schematic">
     (Altium smart pdf)
javascript:alert('
     
      smartpdf
     
     ');
    </p>
   </div>
   <div id="d_FPGA UCF">
    <h2>
     
     
     FPGA UCF
    </h2>
    <p id="p_FPGA UCF">
     column 1 : FPGA pin
     <br/>
     column 2 : CPU or HDR pin
     <br/>
     column 3 : note
     <br/>
     <br/>
     1	EBIA11
     <br/>
     2	RB4
     <br/>
     5	RB5
     <br/>
     6	RE9
     <br/>
     7	RE8
     <br/>
     8	RA0
     <br/>
     9	EBIA2
     <br/>
     10	RG8
     <br/>
     11	RG7
     <br/>
     14	EBIOE	GCLK
     <br/>
     15	EBIWE	GCLK
     <br/>
     16	EBIA12	GCLK
     <br/>
     17	EBIA6	GCLK
     <br/>
     21	EBID7	GCLK
     <br/>
     22	EBID6	GCLK
     <br/>
     23	EBID5	GCLK
     <br/>
     24	EBIA5	GCLK
     <br/>
     26	EBID4
     <br/>
     27	EBID3
     <br/>
     29	EBID2
     <br/>
     30	EBID1
     <br/>
     32	EBID0
     <br/>
     33	EBICS0
     <br/>
     34	EBID8
     <br/>
     35	EBID9
     <br/>
     37	RG13	PROGRAM_B
     <br/>
     39	RG14	INIT_B
     <br/>
     40	EBID10
     <br/>
     41	EBID11
     <br/>
     43	EBID13
     <br/>
     44	EBID12
     <br/>
     45	EBID15
     <br/>
     46	EBID14
     <br/>
     47	IO1
     <br/>
     48	IO2
     <br/>
     50	IO3	GCLK
     <br/>
     51	IO4	GCLK
     <br/>
     55	IO5	GCLK
     <br/>
     56	IO6	GCLK
     <br/>
     57	IO7
     <br/>
     58	IO8
     <br/>
     59	IO9
     <br/>
     61	IO10
     <br/>
     62	NO1
     <br/>
     64	NO2
     <br/>
     65	RG12	DIN
     <br/>
     66	NO3
     <br/>
     67	NO4
     <br/>
     70	RG15	CCLK
     <br/>
     71	RA7	DONE
     <br/>
     74	NO5
     <br/>
     75	NO6
     <br/>
     78	NO7
     <br/>
     79	NO8
     <br/>
     80	NO9
     <br/>
     81	NO10
     <br/>
     82	NO11
     <br/>
     83	NO12
     <br/>
     85	NO16	GCLK
     <br/>
     87	NO17	GCLK
     <br/>
     88	NO18	GCLK
     <br/>
     92	NO13	GCLK
     <br/>
     93	NO14	GCLK
     <br/>
     94	NO15	GCLK
     <br/>
     95	IO20	GCLK
     <br/>
     97	IO19
     <br/>
     98	IO18
     <br/>
     99	IO17
     <br/>
     100	IO11
     <br/>
     101	IO12
     <br/>
     102	IO13
     <br/>
     104	IO14
     <br/>
     105	IO15
     <br/>
     111	IO16
     <br/>
     112	EBIA4
     <br/>
     114	EBIRDY1(86)
     <br/>
     115	RB14
     <br/>
     116	RB13
     <br/>
     117	RB12
     <br/>
     118	RF12
     <br/>
     119	RF13
     <br/>
     120	RA1
     <br/>
     121	EBIA9
     <br/>
     123	EBIA8		GCLK
     <br/>
     124	EBIA3		GCLK
     <br/>
     126	EBIA1		GCLK
     <br/>
     127	RB11		GCLK
     <br/>
     131	RB10(U4RTS)	GCLK
     <br/>
     132	EBIA7		GCLK
     <br/>
     133	EBIA10		GCLK
     <br/>
     134	RH3		GCLK
     <br/>
     137	RA10
     <br/>
     138	RA9
     <br/>
     139	RB0
     <br/>
     140	RB1
     <br/>
     141	RB2
     <br/>
     142	RB3
     <br/>
     143	EBIA0
     <br/>
    </p>
   </div>
   <div id="d_PCB file">
    <h2>
     
     
     PCB file
    </h2>
    <p id="p_PCB file">
     in trunk folder of repository:
     <br/>
     Altium designer project file : SP6_MZ
     <br/>
     Gerber : SP6_MZ_gerber
     <br/>
     <br/>
     pcb manufacturer that i recommend for quality of service : tingriver email:maisuid@gmail.com
    </p>
   </div>
  </div>
  <div style="clear:both;margin-left:200px;">
  </div>
 </div>
</div>
</body>
<p id='foot'>Database updated on 12 June 2015</p>
