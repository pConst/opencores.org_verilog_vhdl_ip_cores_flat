<head>
<link rel="stylesheet" href="../../style.css" type="text/css">
</head>
<a href="javascript:history.go(-1)" onMouseOver="self.status=document.referrer;return true">Go Back</a>
<p align='right'><a href='pcie_vera_tb.tar.gz'>Source code</a></p>
<body>
<div class="main">
 <div class="mid" id="dm">
  <div class="content" id="dmc">
   <h2>
    Details
   </h2>
   <p>
    Name: pcie_vera_tb
    <br/>
    Created: Dec  5, 2007
    <br/>
    Updated: Jan 15, 2008
    <br/>
    SVN Updated: Mar 10, 2009
    
    
    
    
    
    
   </p>
   <h2>
    Other project properties
   </h2>
   <p>
    Category:
    
     System controller
    
    <br/>
    Language:
    
     Other
    
    <br/>
    Development status:
    
    
    <br/>
    Additional info:
    
     Design done
    
    <br/>
    WishBone Compliant: No
    <br/>
    License:
   </p>
   <div id="d_pcie_vera_tb">
    <h2>
     
     
     pcie_vera_tb
    </h2>
    <p id="p_pcie_vera_tb">
     FEATURES
     <br/>
     &#8226;	16 bit PIPE Spec PCI Express Testbench
     <br/>
     &#8226;	Link training
     <br/>
     &#8226;	Initial Flow Control
     <br/>
     &#8226;	Packet Classes for easy to build PHY,DLLP and TLP packets
     <br/>
     &#8226;	DLLP 16 bit CRC and TLP LCRC generation
     <br/>
     &#8226;	Sequence Number generation and checking
     <br/>
     &#8226;	ACK TLP packets
     <br/>
     &#8226;	Scrambling
     <br/>
     &#8226;	MemRd MemWr CfgRd CfgWr TLPs
     <br/>
     <br/>
     Functional Description and Background
     <br/>
     This testbench has been designed to resemble the TI XIO1100 X1 PHY which has a 16 bit 125 MHz PIPE spec interface.  This is a great PCI Express starter VERA testbench.  It can easily be added to, to get the desired results.  The testbench performs link training, initial flow control and TLP generation.  The entire packet is built up including starting and ending symbols as well as the correct LCRC values.  The testbench can be modified fairly easily to put out 8 bits at a time rather than 16 bits.
     <br/>
     Link Training
     <br/>
     The testbench looks for a receiver detect sequence and then a power change sequence to put it into operational mode.  After the PHY is in operational mode training sets will be sent out.  Initially TS1 order sets will be sent by the testbench.  The testbench will also receive TS1 order sets and process them.  When the device under test sends TS2 order sets the testbench will respond with TS2 order sets.  Then the link and lane negotiation will be preformed.  After the logical idles the Testbench will indicate link up.
     <br/>
     Initial Flow Control
     <br/>
     After link up the testbench will generate and receive DLLP initial flow control packets.  These packets include initial credits for non-posted, posted and completion credits.
     <br/>
     These are DLLP packets that have the correct LCRC values attached.
     <br/>
     The initial flow control credits can be easily changed.  Here is a table of there default values.
     <br/>
     <br/>
     Type	Value
     <br/>
     Non-Posted Credit	4 header credits
     <br/>
     Posted Credit	4 header credits,  1k data credit
     <br/>
     Completion Credit	4 header credits,  1k data credit
     <br/>
     Skip Order Sets
     <br/>
     The testbench will send out skip order sets on a regular basis.
     <br/>
     TLP Packet Generation
     <br/>
     There are built in tasks for CfgWr; CfgRd; MemWr and MemRd packet types.  Based on these packets other packet types can easily be made.  The sequence number and LCRC values are correctly generated by the Testbench.  The tasks accept requestor id, byte enables, length, address, tag etc. to allow many unique packet to be generated.
     <br/>
     Data Scrambling/De-scrambling
     <br/>
     The testbench scrambles the 16 bits of data based on the PCI express rules. Scrambling can be bypassed in the testbench.  Scrambling is applied to Data characters associated with DLLPs and TLPs including logical idles and Data characters TS1 and TS2 ordered sets.  K characters are not scrambled and bypass the scramble logic. Compliance pattern related characters are not scrambled. When a COM character exits the scrambler the COM does not get scrambled, but it initializes the LFSR to 16&#8217;hFFFF.  Similarly on the receive side the COM character initializes the de-scrambler to 16&#8217;hFFFF. The LFSR does not advance on SKP characters.  Gutz Logic also offers a 16 bit RTL scrambler/descrambler code.
     <br/>
     File Description
     <br/>
     File	Description
     <br/>
     run_vera	This is the command file to run
     <br/>
     ti_phy_top.test.top.v	Top level testbench linking Vera with the RTL
     <br/>
     ti_phy_top.if.vrh	Interface file
     <br/>
     ti_phy_top.v	Top level non-synthesizable RTL file(add your RTL HERE)
     <br/>
     receive_packet.vri	VERA file for receiving all PCIe packets 16 bits at a time
     <br/>
     send_packet.vri	VERA file for sending all PCIe packets 16 bits at a time
     <br/>
     pcie_phy_packet.vri	VERA file class for PHY layer packets
     <br/>
     pcie_dllp_packet.vri	VERA file class for DLL layer packets
     <br/>
     pcie_tlp_packet.vri	VERA file class for TLP layer packets
     <br/>
     link_training.vri	VERA file for Link Training
     <br/>
     tlp_gen.vri	VERA file for generating TLP packets
     <br/>
     InitFC1.vri	VERA file for Credit Initialization
     <br/>
     skip_order_set.vri	VERA file for generating Skip Order Sets
     <br/>
     scramble8.vri	VERA file for scrambling and descrambling the data
     <br/>
     Additional Tasks to be Added
     <br/>
     The testbench currently does not include credit updates and credit control.  Additional Packet processing including Messages; IOWR; IORD and completion packets. Error Checking, Data compare functions and NACK generation needs to be added  Additional PIPE spec functions such as loopback, electrical idles, Serdes errors
     <br/>
    </p>
   </div>
   <div id="d_pcie_vera_tb Features">
    <h2>
     
     
     pcie_vera_tb Features
    </h2>
    <p id="p_pcie_vera_tb Features">
     -feature1.1	16 bit PIPE Spec PCI Express Testbench
     <br/>
     -feature1.2	Link training
     <br/>
     -feature1.3          Initial Flow Control
     <br/>
     -feature1.4	Packet Classes for easy to build PHY,DLLP and TLP packets
     <br/>
     -feature1.5	DLLP 16 bit CRC and TLP LCRC generation
     <br/>
     -feature1.6          Sequence Number generation and checking
     <br/>
     -feature1.7	ACK TLP packets
     <br/>
     -feature1.8	Scrambling
     <br/>
     -feature1.9           MRd MWr CfgWr CfgRd functions
     <br/>
    </p>
   </div>
   <div id="d_pcie_vera_tb Status">
    <h2>
     
     
     pcie_vera_tb Status
    </h2>
    <p id="p_pcie_vera_tb Status">
     - working
     <br/>
     - beta
    </p>
   </div>
  </div>
  <div style="clear:both;margin-left:200px;">
  </div>
 </div>
</div>
</body>
<p id='foot'>Database updated on 12 June 2015</p>
