<head>
<link rel="stylesheet" href="../../style.css" type="text/css">
</head>
<a href="javascript:history.go(-1)" onMouseOver="self.status=document.referrer;return true">Go Back</a>
<p align='right'><a href='spiflashcontroller.tar.gz'>Source code</a></p>
<body>
<div class="main">
 <div class="mid" id="dm">
  <div class="content" id="dmc">
   <h2>
    Details
   </h2>
   <p>
    Name: spiflashcontroller
    <br/>
    Created: Nov 21, 2006
    <br/>
    Updated: Jul 17, 2014
    <br/>
    SVN Updated: Mar 10, 2009
    
    
    
    
    
    
   </p>
   <h2>
    Other project properties
   </h2>
   <p>
    Category:
    
     Communication controller
    
    <br/>
    Language:
    
     VHDL
    
    <br/>
    Development status:
    
     Beta
    
    <br/>
    Additional info:
    
     Design done
    
    ,
    
     FPGA proven
    
    ,
    
     Specification done
    
    <br/>
    WishBone Compliant: No
    <br/>
    License: GPL
   </p>
   <div id="d_Description">
    <h2>
     
     
     Description
    </h2>
    <p id="p_Description">
     This project implements a controller for standard SPI flash ROMs (e.g. ST M25Pxx, Atmel AT25Fxxxx, etc.).
     <br/>
     For a design using an (embedded) microcontroller it is often a requirement to store user or configuration information. For this purpose the configuration ROM of the FPGA is a first-choice candidate because it is already there and usually has some space left. By using the VHDL module introduced in this project the microcontroller firmware is greatly simplyfied by moving the complexity of accessing the SPI flash to the hardware.
     <br/>
     This core is a spin-off from the "DIY Calculator Hardware" project (URL:
     
      http://diycalculator.pcl.at)
     
     <br/>
     and is maintained by Johannes Hausensteiner (johannes.hausensteiner@pcl.at)
    </p>
   </div>
   <div id="d_Features">
    <h2>
     
     
     Features
    </h2>
    <p id="p_Features">
     The communication to the SPI flash is done through commands which are of different length, with or without parameters, expecting or not responses. The following commands are implemented:
     <br/>
     - WREN: Write Enable; before you can write to the flash it is necessary to send this command
     <br/>
     - WRDI: Write Disable; does what it says
     <br/>
     - RDSR: Read Status Register; the flash chip employs a status register which tells about the chip's state such as write protect, busy, etc.
     <br/>
     - WRSR: Write Status Register; write a new value to the status register
     <br/>
     - READ: read data; reads an arbitrary number of bytes beginning from a supplied address
     <br/>
     - FAST_READ: similar to the READ command, but possibly uses a faster clock
     <br/>
     - PP: Page Program; the flash chip is organised in sectors and pages; an arbitrary number of bytes but a maximum of one page size can be written to the flash
     <br/>
     - SE: Sector Erase; before data can be programmed into the flash it must be erased. It is only possible to erase sectors as a whole.
     <br/>
     - BE: Bulk Erase; erase the whole chip
     <br/>
     - RES: Read Signature; each flash chip contains a signature, which is characteristic for the type of chip
     <br/>
     The SPI Flash Controller acts as a microprocessor peripheral. Communication is done via several registers:
     <br/>
     - Tx data register (write, base plus 0)
     <br/>
     - Rx data register (read, base plus 0)
     <br/>
     - command register (write, base plus 1)
     <br/>
     - status register (read, base plus 1)
     <br/>
     - address mid register (write, base plus 2)
     <br/>
     - address low register (write, base plus 3)
     <br/>
     Note that the address is composed from three bytes. In this implementation the highest byte (= the sector number) is fixed to the topmost sector. Remember that FPGA configuration is stored at the beginning of the flash (starting with address $000000).
     <br/>
     For detailed information see the state diagram (SPI_state-diagram.jpg) and the register description (spi-registers.txt) in the doc sub directory of the project in CVS.
     <br/>
    </p>
   </div>
   <div id="d_Status">
    <h2>
     
     
     Status
    </h2>
    <p id="p_Status">
     - 0.1  25.Sep.2006   JH   new, flash sector number is hard coded to 0x0f
     <br/>
     - 0.1  21.Nov.2006   JH   no changes, submitted to OpenCores.org
     <br/>
    </p>
   </div>
  </div>
  <div style="clear:both;margin-left:200px;">
  </div>
 </div>
</div>
</body>
<p id='foot'>Database updated on 12 June 2015</p>
